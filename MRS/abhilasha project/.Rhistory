utils:::menuInstallPkgs()
install.packages("ggplot2")
install.packages("ggplot2")
library("ggplot2")
q()
install.packages("ggplot2")
library("ggplot2")
census = read.csv("C:/Users/Abhilasha/Desktop/censusData.csv")
View(census)
permiss <- function(dataframe) lapply(dataframe,function(x)
propmiss <- function(dataframe) lapply(dataframe,function(x) data.frame(nmiss=sum(is.na(x)), n=length(x), propmiss=sum(is.na(x))/length(x)))
view(census)
propmiss <- function(dataframe) lapply(dataframe,function(x) data.frame(nmiss=sum(is.na(x)), n=length(x), propmiss=sum(is.na(x))/length(x)))
propmiss(census)
propmiss <- function(dataframe) lapply(dataframe,function(x) data.frame(nmiss=sum(is.?(x)), n=length(x), propmiss=sum(is.?(x))/length(x)))
permiss <- function(dataframe) lapply(dataframe,function(x) data.frame(nmiss=sum(is.?(x)), n=length(x), propmiss=sum(is.?(x))/length(x)))
permiss(census)
df <- read.csv("C:/Users/Abhilasha/Desktop/censusData.csv", na.strings = c("?"))
View(df)
percmiss <- function(dataframe) lapply(dataframe,function(x) data.frame(nmiss=sum(is.na(x)), n=length(x), propmiss=sum(is.na(x))/length(x)))
percmiss(df)
propmiss(df)
cd <- read.csv("C:/Users/Abhilasha/Desktop/censusData.csv", na.strings = c("?"))
View(cd)
source('C:/Users/Abhilasha/Desktop/PRDM_Assignment1.R')
install.packages("ggplot2")
library("ggplot2")
ggplot(NULL, aes(x=row.counts)) + geom_histogram()
source('C:/Users/Abhilasha/Desktop/PRDM_Assignment1.R')
library("ggplot2")
qplot(income, age, data=cd, geom=c("boxplot", "jitter"),
fill=income, main="Age by Income",
xlab="", ylab="Age")
qplot(income, age, data=cd, geom=c("boxplot"),
fill=income, main="Age by Income",
xlab="", ylab="Age")
qplot(income, hrs_per_week, data=cd, geom=c("boxplot"),
fill=income, main="Hrs_per_week by Income",
xlab="", ylab="Hrs_per_week")
qplot(income, hrs_per_week, data=cd, geom=c("boxplot" ,  "jitter"),
fill=income, main="Hrs_per_week by Income",
xlab="", ylab="Hrs_per_week")
p <- qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
p + facet_wrap( ~ income, scales="free")
p + facet_wrap( ~ income)
p + facet_wrap( ~ income, scales="free")
a <- qplot(income, hrs_per_week, data=cd, geom=c("boxplot"), fill=income, main="Hrs_per_week by Income", xlab="", ylab="Hrs_per_week")
a + facet_wrap( ~ income, scales="free")
ggplot(cd, aes(x = work)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
p <- ggplot(subset(cd, !is.na(work)), aes(x=work))
p + geom_bar(stat = "identity", position = "stack")
library(plyr)
count(cd, 'work')
y <- count(mtcars, 'gear')
View(y)
y <- count(cd, 'work')
ggplot(na.omit(y), aes(x=work,y=freq)) + geom_bar()
ggplot(na.omit(y), aes(x=work,y=freq)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ggplot(na.omit(y), aes(x=work,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
ab <- ggplot(cd, aes(x = work)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ab + facet_grid(income ~ .)
ggplot(cd) + geom_boxplot(aes(income, age))
ggplot(cd) + geom_boxplot(aes(work, age))
ggplot(cd) + geom_boxplot(aes(work, age)) + facet_wrap(~ income)
ggplot(cd, aes(x=age, y=hrs_per_week, color= edu)) + geom_point(shape=19, alpha=1/4)
a + facet_wrap( ~ income)
p <- qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
p + facet_wrap( ~ income, scales="free")
p + facet_wrap( ~ income)
p + facet_grid( ~ income, scales="free")
p + facet_grid( ~ income)
p + facet_grid( ~ income, scales="free")
ggplot(cd, aes(x=age, y=hrs_per_week, color= edu)) + geom_point(shape=19, alpha=1/4)
a + facet_grid( ~ income, scales="free")
ggplot(na.omit(y), aes(x=work,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
e <- count(cd, 'edu')
View(e)
ggplot(e, aes(x=edu,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
m <- count(cd, 'marital')
ggplot(m, aes(x=marital,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
o <- count(cd, 'occupation')
ggplot(o, aes(x=occupation,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
ggplot(na.omit(o), aes(x=occupation,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
r <- count(cd, 'race')
ggplot(r, aes(x=race,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
s <- count(cd, 'sex')
ggplot(s, aes(x=sex,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
i <- count(cd, 'income')
ggplot(i, aes(x=income,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
ab + facet_grid(income ~ .)
ab <- ggplot(y, aes(x = work)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ab + facet_grid(income ~ .)
ab <- ggplot(y, aes(x = work)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
ab + facet_grid(income ~ .)
ab + facet_wrap(income ~ .)
ggplot(y, aes(x = work)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
y + facet_grid(income ~ .)
ggplot(y, aes(x = work)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ggplot(y, aes(x = work)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ggplot(na.omit(y), aes(x=work,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
yy <- ggplot(na.omit(y), aes(x=work,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
yy + facet_grid(income ~ .)
ab <- ggplot(cd, aes(x = work)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ab + facet_grid(income ~ .)
yz <- ggplot(na.omit(y), aes(x=work,y=freq)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ggplot(na.omit(y), aes(x=work,y=freq)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ggplot(na.omit(y), aes(x=work)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
ggplot(na.omit(y), aes(x=work)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ab <- ggplot(cd, aes(x = work)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ab + facet_grid(income ~ .)
ef <- ggplot(cd, aes(x = edu)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ef + facet_grid(income ~ .)
gh <- ggplot(cd, aes(x = marital)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
gh + facet_grid(income ~ .)
View(s)
ij <- ggplot(cd, aes(x = occupation)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ij + facet_grid(income ~ .)
kl <- ggplot(cd, aes(x = race)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
kl + facet_grid(income ~ .)
mn <- ggplot(cd, aes(x = sex)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
mn + facet_grid(income ~ .)
op <- ggplot(cd, aes(x = sex)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
op + facet_grid(income ~ .)
op <- ggplot(cd, aes(x = incom)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
op + facet_grid(income ~ .)
op <- ggplot(cd, aes(x = incom)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
op + facet_wrap(income ~ .)
op <- ggplot(cd, aes(x = income)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
op + facet_grid(income ~ .)
propmiss <- function(dataframe) lapply(dataframe,function(x) data.frame(nmiss=sum(is.na(x)), n=length(x), propmiss=sum(is.na(x))/length(x)))
propmiss(cd)
ggplot(NULL, aes(x=row.counts)) + geom_histogram()
qplot(row.counts,geom="histogram",binwidth = 0.5,xlab = "row.counts",fill=I("blue"),col=I("red"),alpha=I(.2),xlim=c(0,5))
row.counts <- rowSums(is.na(cd))
qplot(row.counts,geom="histogram",binwidth = 0.5,xlab = "row.counts",fill=I("blue"),col=I("red"),alpha=I(.2),xlim=c(0,5))
qplot(cd$age,geom="histogram",binwidth = 1,main = "Histogram for Age",xlab = "Age",fill=I("blue"),col=I("red"),alpha=I(.2),xlim=c(0,100))
qplot(cd$hrs_per_week,geom="histogram",binwidth = 1,main = "Histogram for Hrs_per_week",xlab = "Hrs_per_week",fill=I("blue"),col=I("red"),alpha=I(.2),xlim=c(0,100))
hp <- ggplot(cd, aes(x=age)) + geom_histogram(binwidth=2,colour="blue")
hp + facet_grid(income ~ .)
hps <- ggplot(cd, aes(x=hrs_per_week)) + geom_histogram(binwidth=2,colour="blue")
hps + facet_grid(income ~ .)
qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
p <- qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
p + facet_grid( ~ income, scales="free")
qplot(income, hrs_per_week, data=cd, geom=c("boxplot"), fill=income, main="Hrs_per_week by Income", xlab="", ylab="Hrs_per_week")
a <- qplot(income, hrs_per_week, data=cd, geom=c("boxplot"), fill=income, main="Hrs_per_week by Income", xlab="", ylab="Hrs_per_week")
a + facet_grid( ~ income, scales="free")
ggplot(cd) + geom_boxplot(aes(income, age))
ggplot(cd) + geom_boxplot(aes(work, age))
ggplot(cd) + geom_boxplot(aes(work, age)) + facet_wrap(~ income)
y <- count(cd, 'work')
ggplot(na.omit(y), aes(x=work,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
e <- count(cd, 'edu')
ggplot(e, aes(x=edu,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
m <- count(cd, 'marital')
ggplot(m, aes(x=marital,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
o <- count(cd, 'occupation')
ggplot(na.omit(o), aes(x=occupation,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
r <- count(cd, 'race')
ggplot(r, aes(x=race,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
s <- count(cd, 'sex')
ggplot(s, aes(x=sex,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
i <- count(cd, 'income')
ggplot(i, aes(x=income,y=freq)) + geom_bar(stat = "identity", fill = "darkorchid", colour = "black", size = 0.5)
ab <- ggplot(cd, aes(x = work)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ab + facet_grid(income ~ .)
ef <- ggplot(cd, aes(x = edu)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ef + facet_grid(income ~ .)
gh <- ggplot(cd, aes(x = marital)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
gh + facet_grid(income ~ .)
ij <- ggplot(cd, aes(x = occupation)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
ij + facet_grid(income ~ .)
kl <- ggplot(cd, aes(x = race)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
kl + facet_grid(income ~ .)
mn <- ggplot(cd, aes(x = sex)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
mn + facet_grid(income ~ .)
op <- ggplot(cd, aes(x = income)) + geom_bar(stat = "bin", fill = "darkorchid", colour = "black", size = 0.5)
op + facet_grid(income ~ .)
sp <- ggplot(cd, aes(age, hrs_per_week))
sp + geom_point(size = 4)
ggplot(cd, aes(x=age, y=hrs_per_week, color= edu)) + geom_point(shape=19, alpha=1/4)
corage = cd$age
corhrs = cd$hrs_per_week
cor(age, hrs_per_week)
corage = cd$age
corhrs = cd$hrs_per_week
cor(age, hrs_per_week)
cor(corage, corhrs)
corage = cd$age
corhrs = cd$hrs_per_week
cor(corage, corhrs)
z <- qplot(age, sex, data=cd, geom=c("boxplot"), fill=income, main="Sex by Age", xlab="", ylab="Age")
z + facet_grid( ~ income, scales="free")
z <- qplot(sex, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Sex", xlab="", ylab="Sex")
z + facet_grid( ~ income, scales="free")
x <- qplot(sex, work, data=cd, geom=c("boxplot"), fill=income, main="Work by Sex", xlab="", ylab="Work")
x + facet_grid( ~ income, scales="free")
x <- qplot(work, sex, data=cd, geom=c("boxplot"), fill=income, main="Sex by Work", xlab="", ylab="Sex")
x + facet_grid( ~ income, scales="free")
qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
zz <- qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
zz + facet_grid( ~ sex, scales="free")
zz + facet_grid( sex ~, scales="free")
zz + facet_grid( sex ~ ., scales="free")
zz <- qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
zz + facet_grid( sex ~ ., scales="free")
zz <- qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
zz + facet_grid( sex ~ ., scales="free")
p <- qplot(income, age, data=cd, geom=c("boxplot"), fill=income, main="Age by Income", xlab="", ylab="Age")
p + facet_grid( ~ income, scales="free")
a <- qplot(income, hrs_per_week, data=cd, geom=c("boxplot"), fill=income, main="Hrs_per_week by Income", xlab="", ylab="Hrs_per_week")
a + facet_grid( ~ income, scales="free")
v <- qplot(income, hrs_per_week, data=cd, geom=c("boxplot"), fill=income, main="Hrs_per_week by Income", xlab="", ylab="Hrs_per_week")
v + facet_grid(sex ~ ., scales="free")
ggplot(cd, aes(x=age, y=hrs_per_week, color= edu)) + geom_point(shape=19, alpha=1/4)
setwd("C:/Users/Abhilasha/final year R project/abhilasha project")
options(digits=4)
#data <- read.csv(file="lastfm-data.csv")
data.artist <- read.csv(file="lastfm-matrix-artist.csv")
data.artist.ibs <- (data.artist[,!(names(data.artist) %in% c("user"))])
getCosine <- function(x,y)
{
this.cosine <- sum(x*y) / (sqrt(sum(x*x)) * sqrt(sum(y*y)))
return(this.cosine)
}
holder <- matrix(NA, nrow=ncol(data.artist.ibs),ncol=ncol(data.artist.ibs),dimnames=list(colnames(data.artist.ibs),colnames(data.artist.ibs)))
data.artist.ibs.similarity <- as.data.frame(holder)
for(i in 1:ncol(data.artist.ibs)) {
for(j in 1:ncol(data.artist.ibs)) {
data.artist.ibs.similarity[i,j]= getCosine(data.artist.ibs[i],data.artist.ibs[j])
}
}
write.csv(data.artist.ibs.similarity,file="final-artist-similarity.csv")
data.artist.neighbours <- matrix(NA, nrow=ncol(data.artist.ibs.similarity),ncol=11,dimnames=list(colnames(data.artist.ibs.similarity)))
for(i in 1:ncol(data.artist.ibs))
{
data.artist.neighbours[i,] <- (t(head(n=11,rownames(data.artist.ibs.similarity[order(data.artist.ibs.similarity[,i],decreasing=TRUE),][i]))))
}
write.csv(file="final-artist-item-neighbours.csv",x=data.artist.neighbours[,-1])
getScore <- function(history, similarities)
{
x <- sum(history*similarities)/sum(similarities)
x
}
holder <- matrix(NA, nrow=nrow(data.artist),ncol=ncol(data.artist)-1,dimnames=list((data.artist$user),colnames(data.artist[-1])))
for(i in 1:nrow(holder))
{
# Loops through the products (columns)
for(j in 1:ncol(holder))
{
user <- rownames(holder)[i]
product <- colnames(holder)[j]
if(as.integer(data.artist[data.artist$user==user,product]) == 1)
{
holder[i,j]<-""
} else {
topN.names <- as.character(rownames(topN))
topN<-((head(n=11,(data.artist.ibs.similarity[order(data.artist.ibs.similarity[,product],decreasing=TRUE),][product]))))
topN.similarities <- as.numeric(topN[,1])
topN.similarities<-topN.similarities[-1]
topN.names<-topN.names[-1]
topN.purchases<- data.artist[,c("user",topN.names)]
topN.userPurchases<-topN.purchases[topN.purchases$user==user,]
topN.userPurchases <- as.numeric(topN.userPurchases[!(names(topN.userPurchases) %in% c("user"))])
holder[i,j]<-getScore(similarities=topN.similarities,history=topN.userPurchases)
}
}
}
data.artist.user.scores <- holder
write.csv(file="final-user-scores.csv",data.artist.user.scores)
data.artist.user.scores.holder <- matrix(NA, nrow=nrow(data.artist.user.scores),ncol=100,dimnames=list(rownames(data.artist.user.scores)))
for(i in 1:nrow(data.artist.user.scores))
{
data.artist.user.scores.holder[i,] <- names(head(n=100,(data.artist.user.scores[,order(data.artist.user.scores[i,],decreasing=TRUE)])[i,]))
}
write.csv(file="final-user-recommendations.csv",data.artist.user.scores.holder)
